# AWS アクセスキーの取得方法（詳細ガイド）

## 目次
1. [IAMユーザー作成後の画面](#1-iamユーザー作成後の画面)
2. [アクセスキーの見つけ方](#2-アクセスキーの見つけ方)
3. [アクセスキーを失くした場合](#3-アクセスキーを失くした場合)

---

## 1. IAMユーザー作成後の画面

IAMユーザーを作成すると、以下のような画面が表示されます：

```
✅ ユーザーが正常に作成されました

ユーザー名: meishiplus-s3-uploader

アクセスキーID: AKIAIOSFODNN7EXAMPLE
シークレットアクセスキー: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

[.csvファイルをダウンロード] [閉じる]
```

### この画面で確認できる情報
- **アクセスキーID**: `AWS_ACCESS_KEY_ID`に使用
- **シークレットアクセスキー**: `AWS_SECRET_ACCESS_KEY`に使用

---

## 2. アクセスキーの見つけ方

### 方法1: ユーザー作成直後の画面から（推奨）
1. ユーザー作成完了画面で表示される
2. その場でコピーするか、CSVファイルをダウンロード

### 方法2: IAMコンソールから確認
もし画面を閉じてしまった場合：

1. [IAMコンソール](https://console.aws.amazon.com/iam/) にログイン
2. 左メニューから「ユーザー」をクリック
3. 作成したユーザー名（例: `meishiplus-s3-uploader`）をクリック
4. 「セキュリティ認証情報」タブをクリック
5. 「アクセスキー」セクションを確認

⚠️ **注意**: シークレットアクセスキーは表示されません。表示されるのはアクセスキーIDのみです。

---

## 3. アクセスキーを失くした場合

シークレットアクセスキーは一度しか表示されないため、失くした場合は新しいキーを作成する必要があります。

### 新しいアクセスキーを作成する手順

1. [IAMコンソール](https://console.aws.amazon.com/iam/) にログイン
2. 左メニューから「ユーザー」をクリック
3. 該当するユーザー名をクリック
4. 「セキュリティ認証情報」タブをクリック
5. 「アクセスキー」セクションで「アクセスキーを作成」をクリック
6. 使用目的を選択（「ローカルコード」を推奨）
7. 「次へ」をクリック
8. 説明（オプション）を入力して「アクセスキーを作成」をクリック
9. **新しいアクセスキーIDとシークレットアクセスキーが表示されます**
10. 必ずこの画面でコピーまたはCSVダウンロードしてください

### 古いアクセスキーの削除（推奨）

セキュリティのため、古いアクセスキーは削除することを推奨します：

1. 同じ「セキュリティ認証情報」タブで
2. 古いアクセスキーの横にある「削除」をクリック
3. 確認して削除

---

## 4. 環境変数への設定

取得したアクセスキーを`.env.local`ファイルに設定：

```env
# AWS S3設定
AWS_REGION=ap-northeast-1
AWS_ACCESS_KEY_ID=ここにアクセスキーIDを貼り付け
AWS_SECRET_ACCESS_KEY=ここにシークレットアクセスキーを貼り付け
AWS_S3_BUCKET_NAME=meishiplus-images
```

### 設定例

```env
AWS_REGION=ap-northeast-1
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
AWS_S3_BUCKET_NAME=meishiplus-images
```

---

## よくある質問

### Q: アクセスキーIDとシークレットアクセスキーの違いは？
- **アクセスキーID**: 公開しても問題ない（例: `AKIAIOSFODNN7EXAMPLE`）
- **シークレットアクセスキー**: 絶対に秘密にすべき（例: `wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY`）

### Q: シークレットアクセスキーを忘れたら？
- 新しいアクセスキーを作成する必要があります
- 古いキーは削除して、新しいキーを使用してください

### Q: アクセスキーはどこに保存すべき？
- `.env.local`ファイル（ローカル開発用）
- Vercelの環境変数（本番環境用）
- **絶対にGitにコミットしないでください**

---

## セキュリティのベストプラクティス

1. ✅ アクセスキーは`.env.local`に保存（`.gitignore`に含まれていることを確認）
2. ✅ 本番環境ではVercelの環境変数を使用
3. ✅ 定期的にアクセスキーをローテーション（変更）
4. ✅ 不要になったアクセスキーは削除
5. ❌ アクセスキーをGitにコミットしない
6. ❌ アクセスキーを公開リポジトリにアップロードしない
